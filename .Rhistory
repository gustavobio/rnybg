http://www.uol.com.br
install.packages(c("devtools", "roxygen2", "testthat", "knitr"))
devtools::install_github("hadley/devtools")
require(rvest)
specimen_page <- read_html("http://sweetgum.nybg.org/vh/specimen.php?irn=2624301")
specimen_page
details <- specimen_page %>%
html_notes("tr:nth-child(5) .emuDisplayTableValue") %>%
html_text()
details <- specimen_page %>%
html_nodes("tr:nth-child(5) .emuDisplayTableValue") %>%
html_text()
details
trimws(details)
details <- specimen_page %>%
html_nodes("tr:nth-child(5) .emuDisplayTableValue") %>%
trimws(html_text())
open_image <- specimen_page %>%
html_nodes("h2+ a") %>%
html_text
open_image
open_image <- specimen_page %>%
html_nodes("h2+ a") %>%
html_attr("src")
open_image
/html_name()
?html_name()
open_image <- specimen_page %>%
html_nodes("h2+ a") %>%
html_attr("href")
open_image
open_image <- paste("http://sweetgum.nybg.org/", open_image)
open_image
paste("1 ", "2")
paste("1 ", "2", collapse = "")
paste("1 ", "2", sep = "")
?paste0
open_image <- specimen_page %>%
html_nodes("h2+ a") %>%
html_attr("href")
open_image <- paste0("http://sweetgum.nybg.org", open_image)
open_image
open("open_image")
?open
?browseURL
browseURL(open_image)
open_image <- specimen_page %>%
html_nodes("#columns img") %>%
html_attr("href")
open_image <- paste0("http://sweetgum.nybg.org", open_image)
open_image
open_image <- specimen_page %>%
html_nodes("#columns tr+ tr a") %>%
html_attr("href")
open_image <- paste0("http://sweetgum.nybg.org", open_image)
open_image
browseURL(open_image)
install_github("ropensci/rgbif")
devtools::install_github("ropensci/rgbif")
details <- trimws(details)
require(rgbif)
occ_get(key = 252408386)
occ_get
?occ_get
occ_get(key = 252408386, fields = 'all')
occ_get(key = 252408386, fields = 'all', verbatim = TRUE)
?name_lookup
name_lookup
specimens <- function(query) {
name_lookup(query = query, datasetKey = "d415c253-4d61-4459-9d25-4015b9084fb0")
}
specimens("Melastomataceae")
name
name_lookup("Melastomataceae", datasetKey = "d415c253-4d61-4459-9d25-4015b9084fb0")
name_lookup("Melastomataceae")
name_lookup("Melastomataceae", datasetKey = "d415c253-4d61-4459-9d25-4015b9084fb0")
name_lookup(datasetKey='3f8a1297-3259-4700-91fc-acc4170b27ce')
name_lookup("Fabales", datasetKey='3f8a1297-3259-4700-91fc-acc4170b27ce')
name_lookup("Fabales", datasetKey='d415c253-4d61-4459-9d25-4015b9084fb0')
name_lookup("Fabales", datasetKey='7133ff0a-f762-11e1-a439-00145eb45e9a')
name_lookup(datasetKey='7133ff0a-f762-11e1-a439-00145eb45e9a')
name_lookup(datasetKey='d415c253-4d61-4459-9d25-4015b9084fb0')
name_lookup
name_lookup()
name_lookup
name_lookup(datasetKey='d415c253-4d61-4459-9d25-4015b9084fb0')
head(name_lookup(datasetKey='d415c253-4d61-4459-9d25-4015b9084fb0'))
traceback()
name_lookup(datasetKey='d415c253-4d61-4459-9d25-4015b9084fb0', limit = 1)
name_lookup(q = "Fabaceae", datasetKey='d415c253-4d61-4459-9d25-4015b9084fb0', limit = 1)
rgbif:::movecols()
rgbif:::movecols
name_lookup(q = "Fabaceae", datasetKey='d415c253-4d61-4459-9d25-4015b9084fb0', limit = 1, verbose = T)
name_lookup(datasetKey='d415c253-4d61-4459-9d25-4015b9084fb0', limit = 1, verbose = T)
?occ_search
occ_search(datasetKey = "d415c253-4d61-4459-9d25-4015b9084fb0", limit = 1)
?name_suggest()
name_suggest("Myrcia lingua")
name_suggest("Melastomataceae")
occ_search(datasetKey = "d415c253-4d61-4459-9d25-4015b9084fb0", limit = 1, query = "Melastomataceae")
occ_search(datasetKey = "d415c253-4d61-4459-9d25-4015b9084fb0", limit = 1, query = "Myrtaceae")
?occ_search
occ_search(datasetKey = "d415c253-4d61-4459-9d25-4015b9084fb0", limit = 1, search = "Myrtaceae")
occ_search(datasetKey = "d415c253-4d61-4459-9d25-4015b9084fb0", limit = 10, search = "Myrtaceae")
head(occ_search(datasetKey = "d415c253-4d61-4459-9d25-4015b9084fb0", limit = 10, search = "Myrtaceae"))
head(occ_search(datasetKey = "d415c253-4d61-4459-9d25-4015b9084fb0", limit = 10, search = "Myrcia lingua"))
occ_search
head(occ_search(datasetKey = "d415c253-4d61-4459-9d25-4015b9084fb0", limit = 10, search = "Myrcia linguaa"))
head(occ_search(datasetKey = "d415c253-4d61-4459-9d25-4015b9084fb0", limit = 10, search = "flor"))
?match.arg
?is.numeric
?occ_get
occ_get(catalogNumber = 1184769, datasetKey = "d415c253-4d61-4459-9d25-4015b9084fb0")
occ_search(catalogNumber = 1184769, datasetKey = "d415c253-4d61-4459-9d25-4015b9084fb0")
occ_search(catalogNumber = 1184769, datasetKey = "d415c253-4d61-4459-9d25-4015b9084fb0")[1]
test <- occ_search(catalogNumber = 1184769, datasetKey = "d415c253-4d61-4459-9d25-4015b9084fb0")
str(test)
?occ_search
test$data
test <- occ_search(catalogNumber = 1184769, datasetKey = "d415c253-4d61-4459-9d25-4015b9084fb0", return = 'data')
test$data\
test$data
test
test
test$http...unknown.org.occurrenceDetails
test <- occ_search(catalogNumber = 1184769, datasetKey = "d415c253-4d61-4459-9d25-4015b9084fb0", return = 'meta')
test$data
test <- occ_search(catalogNumber = 1184769, datasetKey = "d415c253-4d61-4459-9d25-4015b9084fb0", return = 'data')
test$data
test <- occ_search(catalogNumber = 1184769, datasetKey = "d415c253-4d61-4459-9d25-4015b9084fb0", return = 'all')
test$data
head(occ_search(datasetKey = "d415c253-4d61-4459-9d25-4015b9084fb0", limit = 10, search = "Myrcia lingua"))
name_lookup("Myrcia lingua")
name_lookup("Myrcia guianensis")
test$data
occ_get("1097153516")
occ_get(1097153516)
occ_get(1097153516)$data
?occ_get
occ_get(1097153516, return = data, fields = 'all')
occ_get(1097153516, return = 'data', fields = 'all')
test$data
names(test$data)
grep("occurrenceDetails", names(test$data))
specimen_description <- function(ny_id = 1184769, ...) {
if (!is.numeric(ny_id)) stop("The ID must be numeric.")
gbif_response <- occ_search(catalogNumber = ny_id, datasetKey = "d415c253-4d61-4459-9d25-4015b9084fb0", ...)
specimen_page <- read_html(paste0("http://sweetgum.nybg.org/vh/specimen.php?irn=", ny_id))
description <- specimen_page %>%
html_nodes("tr:nth-child(5) .emuDisplayTableValue") %>%
html_text()
description <- trimws(description)
names(gbif_response)[grep("occurrenceDetails", names(gbif_response))] <- "occurrenceDetails"
gbif_response$occurrenceDetails <- description
return(gbif_response)
}
specimen_description()
specimen_description()$data
?match.arg()
match.arg(..., "test")
?exists
?occ_search
?match.arg
dots <- function(...) {
eval(substitute(alist(...)))
}
dots(test)
dots(test, test1)
dots <- function(...) {
(substitute(alist(...)))
}
dots(test, test1)
dots <- function(...) {
eval(substitute(alist(...)))
}
dots(test, test1)
dots(test, test1)[[1]]
class(dots(test, test1)[[1]])
class(dots(test, test1)[[1]])[1]
class(dots(test, test1)[[1]][[1]])
class(dots(test, test1)[[1]][1])
dots(test, test1)[[1]]
dots(test, test1)[[1]] == test
dots(test, test1)[[1]] == 'test'
dots(test, test1)[[1]] == 'test1'
dots(test, test1)[[1]] == 'test2'
dots(test, test1)[[1]] == 'tes'
args
test2 <- dots(test, test1)
test2
lapply(test2, function(x) x == 'test1')
any(lapply(test2, function(x) x == 'test1'))
lapply(test2, function(x) x == 'test1')
unlist(lapply(test2, function(x) x == 'test1'))
any(unlist(lapply(test2, function(x) x == 'test1')))
unlist(test2)
unlist(test2)
?occ_search
test2 <- dots(test, test1 = 'all')
test2
test2$test3
test2$test3 == 'all'
exists(test2$test1)
exists(test2$test3)
test2 <- dots(test, test1 = 'all')
test2
test2$test1
test2$test1 == 'any'
test2$test2 == 'any'
isTRUE(test2$test2 == 'any')
isTRUE(test2$test2 == 'all')
isTRUE(test2$test1 == 'all')
specimen_description <- function(ny_id = 1184769, ...) {
if (!is.numeric(ny_id)) stop("The ID must be numeric.")
gbif_response <- occ_search(catalogNumber = ny_id, datasetKey = "d415c253-4d61-4459-9d25-4015b9084fb0", ...)
specimen_page <- read_html(paste0("http://sweetgum.nybg.org/vh/specimen.php?irn=", ny_id))
description <- specimen_page %>%
html_nodes("tr:nth-child(5) .emuDisplayTableValue") %>%
html_text()
description <- trimws(description)
dot_args <- eval(substitute(alist(...)))
if (isTRUE(dot_args$return == 'all')) {
names(gbif_response$data)[grep("occurrenceDetails", names(gbif_response$data))] <- "occurrenceDetails"
gbif_response$data$occurrenceDetails <- description
} else {
names(gbif_response)[grep("occurrenceDetails", names(gbif_response))] <- "occurrenceDetails"
gbif_response$occurrenceDetails <- description
}
return(gbif_response)
}
specimen_description()
specimen_description()$data
names(test2)
specimen_description <- function(ny_id = 1184769, ...) {
if (!is.numeric(ny_id)) stop("The ID must be numeric.")
gbif_response <- occ_search(catalogNumber = ny_id, datasetKey = "d415c253-4d61-4459-9d25-4015b9084fb0", ...)
specimen_page <- read_html(paste0("http://sweetgum.nybg.org/vh/specimen.php?irn=", ny_id))
description <- specimen_page %>%
html_nodes("tr:nth-child(5) .emuDisplayTableValue") %>%
html_text()
description <- trimws(description)
dot_args <- eval(substitute(alist(...)))
if (!('return' %in% names(dot_args)) | isTRUE(dot_args$return == 'all')) {
names(gbif_response$data)[grep("occurrenceDetails", names(gbif_response$data))] <- "occurrenceDetails"
gbif_response$data$occurrenceDetails <- description
} else {
names(gbif_response)[grep("occurrenceDetails", names(gbif_response))] <- "occurrenceDetails"
gbif_response$occurrenceDetails <- description
}
return(gbif_response)
}
specimen_description()$data
specimen_description(return = 'data')
ny_id = 1184769
res <- occ_search(catalogNumber = ny_id, datasetKey = "d415c253-4d61-4459-9d25-4015b9084fb0", ...)
res <- occ_search(catalogNumber = ny_id, datasetKey = "d415c253-4d61-4459-9d25-4015b9084fb0")
res
res$meta
?occ_search
str(res)
is.list(res)
is.list(data.frame())
class(res)
typeof(res)
typeof(data.frame())
?download.file
cat(getwd())
?messa
?message
message("Downloading image to", getwd())
?download.file
require(rvest)
require(rgbif)
specimen_page <- function(ny_id) {
paste0("http://sweetgum.nybg.org/vh/specimen.php?irn=", ny_id)
}
get_description <- function(ny_id = ny_id) {
description <- read_html(specimen_page(ny_id)) %>%
html_nodes("tr:nth-child(5) .emuDisplayTableValue") %>%
html_text()
description <- trimws(description)
return(description)
}
fill_description <- function(ny_id = 1184769, ...) {
if (!is.numeric(ny_id)) stop("The ID must be numeric.")
dot_args <- eval(substitute(alist(...)))
return_all <- !('return' %in% names(dot_args)) | isTRUE(dot_args$return == 'all')
gbif_response <- occ_search(catalogNumber = ny_id, datasetKey = "d415c253-4d61-4459-9d25-4015b9084fb0", ...)
description <- get_description(ny_id)
if (return_all) {
names(gbif_response$data)[grep("occurrenceDetails", names(gbif_response$data))] <- "occurrenceDetails"
gbif_response$data$occurrenceDetails <- description
} else {
names(gbif_response)[grep("occurrenceDetails", names(gbif_response))] <- "occurrenceDetails"
gbif_response$occurrenceDetails <- description
}
return(gbif_response)
}
get_image_url <- function(ny_id) {
image_url <- read_html(specimen_page(ny_id)) %>%
html_nodes("#columns tr+ tr a") %>%
html_attr("href")
return(paste0("http://sweetgum.nybg.org", image_url))
}
open_image <- function(ny_id) {
browseURL(get_image_url(ny_id))
}
download_image <- function(ny_id, verbose = TRUE) {
image_url <- get_image_url(ny_id)
filename <- basename(image_url)
message("Downloading image to", getwd())
download.file(image_url, destfile = filename)
}
ny_id = 02104113
specimen_page()
specimen_page(ny_id)
get_description(ny_id)
get_description(ny_id = ny_id)
get_description <- function(ny_id) {
description <- read_html(specimen_page(ny_id)) %>%
html_nodes("tr:nth-child(5) .emuDisplayTableValue") %>%
html_text()
description <- trimws(description)
return(description)
}
get_description(ny_id = 1184769)
fill_description(1184769)
fill_description(1184769)$data
tt <- read.csv("~/Downloads/Duivenvoodren_etal1994_table.csv", sep = ";")
head(tt)
require(dplyr)
?separete
separate
require(tidyr)
?separate
separate(tt, especies, c("especies", "bleh"), sep = "\\((?:.(?!\\())+$")
head(separate(tt, especies, c("especies", "bleh"), sep = "\\((?:.(?!\\())+$"))
head(separate(tt, especies, c("especies", "bleh"), sep = "\((?:.(?!\())+$"))
head(separate(tt, especies, c("especies", "bleh"), sep = "\\((?:.(?!\\())+$"))
head(species)
head(tt)
?regexpr
?regmatches
tt <- read.csv("~/Downloads/Duivenvoodren_etal1994_table.csv", sep = ";")
m <- regexpr("\\((?:.(?!\\())+$", tt$especies)
regmatches(tt$especies, m)
m <- regexpr("\((?:.(?!\())+$", tt$especies)
m <- regexpr("\\((?:.(?!\\())+$", tt$especies)
gsub("\\((?:.(?!\\())+$", "", tt$especies)
gsub("\\((?:.(?!\\())+$", "", tt$especies, pearl = T)
?gsub
gsub("\\((?:.(?!\\())+$", "", tt$especies, perl = T)
m <- regexpr("\\((?:.(?!\\())+$", tt$especies, perl = T)
regmatches(tt$especies, m)
regmatches(tt$especies, m, invert = T)
?regmatches(tt$especies, m)
regmatches(tt$especies, m)
regmatches(tt$especies, m, invert = TRUE)
gsub("\\((?:.(?!\\())+$", "", tt$especie)
gsub("\\((?:.(?!\\())+$", "", tt$especie, perl = T)
tail(tt)
tt <- read.csv("~/Downloads/Duivenvoodren_etal1994_table.csv", sep = ";")
m <- regexpr("\\((?:.(?!\\())+$", tt$especies, perl = T)
tt$new <- regmatches(tt$especies, m)
tt$especies <- gsub("\\((?:.(?!\\())+$", "", tt$especie, perl = T)
head(tt)
ny_id
get_description(ny_id)
require(rvest)
require(rgbif)
require(rvest)
get_description(ny_id)
get_description(1184769)
specimen_page(ny_id)
occ_search(catalogNumber = ny_id, datasetKey = "d415c253-4d61-4459-9d25-4015b9084fb0", ...)
occ_search(catalogNumber = ny_id, datasetKey = "d415c253-4d61-4459-9d25-4015b9084fb0")
occ_search(catalogNumber = 1889108, datasetKey = "d415c253-4d61-4459-9d25-4015b9084fb0")
occ_search(catalogNumber = 1889108, datasetKey = "d415c253-4d61-4459-9d25-4015b9084fb0", return = 'data')
?occ_search(catalogNumber = 1889108, datasetKey = "d415c253-4d61-4459-9d25-4015b9084fb0", return = 'data')
tt< - occ_search(catalogNumber = 1889108, datasetKey = "d415c253-4d61-4459-9d25-4015b9084fb0", return = 'data')
tt<- occ_search(catalogNumber = 1889108, datasetKey = "d415c253-4d61-4459-9d25-4015b9084fb0", return = 'data')
tt
tt[grep("occurrenceDetails", names(tt))]
tt[1, grep("occurrenceDetails", names(tt))]
tt[, grep("occurrenceDetails", names(tt))]
specimen_page <- function(ny_id) {
gbif_response <- occ_search(catalogNumber = ny_id, datasetKey = "d415c253-4d61-4459-9d25-4015b9084fb0", return = 'data')
gbif_response[, grep("occurrenceDetails", names(gbif_response))]
}
specimen_page(ny_id)
gbif_response <- occ_search(catalogNumber = ny_id, datasetKey = "d415c253-4d61-4459-9d25-4015b9084fb0", return = 'data')
gbif_response
ny_id
ny_id = 01889108
specimen_page(ny_id)
open_image <- function(ny_id) {
browseURL(get_image_url(ny_id))
}
open_image(ny_id)
path
source('~/Documents/nybg/R/hello.R')
fill_description()
fill_description(return = 'data')
specimen_page(1184769)
open_image(1184769)
?person()
sessionInfo()
devtools::document()
devtools::document()
devtools::document()
devtools::document()
ny_id
devtools::document()
devtools::document()
install()
require(devtools)
install()
